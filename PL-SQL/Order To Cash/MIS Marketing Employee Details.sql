SELECT
PPF.EMPLOYEE_NUMBER
,PPF.FULL_NAME EMPLOYEE_NAME
,APPS.XXAKG_ORACLE_PKG.GET_CONTACT_NUMBER (ppf.person_id, 'C1')OFFICE_NUMBER
--,APPS.XXAKG_ORACLE_PKG.GET_SUPERVISOR_ID(PPF.PERSON_ID) SUPERVISOR_ID
--,APPS.XXAKG_ORACLE_PKG.GET_SUPERVISOR_NAME(PPF.PERSON_ID) SUPERVISOR_NAME
--,PPF.EFFECTIVE_START_DATE
--,PPF.MARITAL_STATUS
--,PPF.NATIONAL_IDENTIFIER
--,DECODE(PPF.SEX,'M','MALE','F','FEMALE','OTHERS') GENDER
--,PPF.ATTRIBUTE1 BLOOD_GROUP
--,PPF.ATTRIBUTE2 RELIGN
--,PPF.ATTRIBUTE7 HIGHT
--,APPS.XXAKG_ORACLE_PKG.GET_HIGHEST_QUALIFICATION(PPF.PERSON_ID) HIGHEST_QUALIFICATION
--,APPS.XXAKG_ORACLE_PKG.GET_TOTAL_EXPERIENCE(PPF.PERSON_ID) TOTAL_EXPERIENCE
--,APPS.XXAKG_ORACLE_PKG.GET_PERSON_TYPE(PPF.PERSON_ID) PERSON_TYPE
--,APPS.XXAKG_ORACLE_PKG.GET_PERSON_NAME(PPF.PERSON_ID) PERSON_NAME
--,APPS.XXAKG_ORACLE_PKG.GET_ENAME_FRM_ENUM(PPF.EMPLOYEE_NUMBER) GET_ENAME_FRM_ENUM
--,PPF.*
,SPAPF.EMPLOYEE_NUMBER SUPERVISOR_EMP_NUM,
           NVL (SPAPF.FULL_NAME, 'NONE') SUPERVISOR_NAME
           ,pjd.SEGMENT3 DESIGNATION
FROM
APPS.PER_PEOPLE_F PPF
,APPS.PER_ALL_ASSIGNMENTS_F PAAF
,APPS.PER_PEOPLE_X SPAPF
,APPS.PER_JOBS PJ
,APPS.PER_JOB_DEFINITIONS PJD
--,APPS.PER_PHONES PP
--,APPS.HZ_CUST_ACCOUNTS CA
WHERE 1=1
--AND PP.PHONE_NUMBER=CA.ATTRIBUTE9
--AND PPF.PERSON_ID=PP.PARENT_ID 
AND PJD.JOB_DEFINITION_ID=PJ.JOB_DEFINITION_ID
AND NVL (PAAF.JOB_ID, 1) = PJ.JOB_ID
AND PPF.PERSON_ID=PAAF.PERSON_ID
AND PAAF.SUPERVISOR_ID=SPAPF.PERSON_ID
AND PPF.EMPLOYEE_NUMBER=:P_EMPLOYEE_NUMBER
--IN ('1609',
--'2115',
--'23771',
--'12726',
--'23778',
--'26893',
--'1904',
--'8245',
--'22546',
--'35437',
--'13901',
--'10842',
--'37162',
--'25016',
--'29364',
--'12725',
--'14192',
--'22548',
--'23768',
--'13718',
--'2239',
--'1906',
--'34411',
--'23769',
--'13035',
--'2014',
--'33345',
--'13730',
--'25237',
--'27124',
--'20579',
--'25321',
--'23787',
--'13993',
--'23789',
--'25328',
--'14406',
--'14405',
--'25327',
--'14322',
--'14404',
--'14408',
--'14376',
--'25749',
--'13720',
--'22547',
--'13922',
--'18330',
--'14377',
--'14367',
--'7969',
--'13729',
--'13719')
AND SYSDATE BETWEEN PPF.EFFECTIVE_START_DATE AND PPF.EFFECTIVE_END_DATE
AND SYSDATE BETWEEN PAAF.EFFECTIVE_START_DATE AND PAAF.EFFECTIVE_END_DATE


--------------------------------------------------------------------------------

SELECT DISTINCT
RBC.REGION_NAME,
--RBC.BLOCK_NAME,
--RBC.CELL_NAME,
--CA.ACCOUNT_NUMBER CUSTOMER_NUMBER,
--HP.PARTY_NAME CUSTOMER_NAME,
AED.EMPLOYEE_NUMBER,
AED.FULL_NAME,
AED.DESIGNATION,
APPS.XXAKG_ORACLE_PKG.GET_CONTACT_NUMBER (AED.person_id, 'C1')OFFICE_NUMBER,
CA.ATTRIBUTE9 "Officer Phone Number"
,SUPERVISOR_ID
,SUPERVISOR_NAME
--CA.ACCOUNT_NAME,
--CA.STATUS ACCOUNT_STATUS,
--CSUA.STATUS CUSTOMER_SITE_STATUS,
--CA.CREATION_DATE "ACCOUNT CREATION DATE",
--CASA.CREATION_DATE "ACCOUNT SITE CREATION DATE",
--CSUA.SITE_USE_CODE,
--CSUA.LOCATION
--,RBC.*
FROM
APPS.HZ_CUST_ACCOUNTS CA,
APPS.HZ_PARTIES HP,
APPS.HZ_CUST_SITE_USES_ALL CSUA,
APPS.HZ_CUST_ACCT_SITES_ALL CASA
,APPS.XXAKG_REGION_BLOCK_CELL_V RBC
,APPS.PER_PHONES PP
,APPS.AKG_EMPLOYEE_DETAILS AED
WHERE 1=1
AND CA.CUST_ACCOUNT_ID=RBC.CUSTOMER_ID
AND CA.PARTY_ID=HP.PARTY_ID
AND CSUA.CUST_ACCT_SITE_ID=CASA.CUST_ACCT_SITE_ID
AND CA.CUST_ACCOUNT_ID=CASA.CUST_ACCOUNT_ID
--AND CA.STATUS='A'
--AND CSUA.STATUS='A'
--AND PERSON_STATUS='Active Assignment'
AND PP.PHONE_NUMBER=CA.ATTRIBUTE9
AND AED.PERSON_ID=PP.PARENT_ID 
AND CA.ATTRIBUTE9 IS NOT NULL
--AND CA.ATTRIBUTE9='01713441645'
AND CSUA.SITE_USE_CODE='BILL_TO'
--AND RBC.CUSTOMER_NUMBER='34262'
AND RBC.ORG_ID=85
AND EMPLOYEE_NUMBER--=:P_EMPLOYEE_NUMBER
IN ('1609',
'2115',
'23771',
'12726',
'23778',
'26893',
'1904',
'8245',
'22546',
'35437',
'13901',
'10842',
'37162',
'25016',
'29364',
'12725',
'14192',
'22548',
'23768',
'13718',
'2239',
'1906',
'34411',
'23769',
'13035',
'2014',
'33345',
'13730',
'25237',
'27124',
'20579',
'25321',
'23787',
'13993',
'23789',
'25328',
'14406',
'14405',
'25327',
'14322',
'14404',
'14408',
'14376',
'25749',
'13720',
'22547',
'13922',
'18330',
'14377',
'14367',
'7969',
'13729',
'13719')

--------------------------------------------------------------------------------
SELECT DISTINCT
RBC.REGION_NAME,
--RBC.BLOCK_NAME,
--RBC.CELL_NAME,
CA.ACCOUNT_NUMBER CUSTOMER_NUMBER,
HP.PARTY_NAME CUSTOMER_NAME,
AED.EMPLOYEE_NUMBER OFFICER_ID,
AED.FULL_NAME OFFICER_NAME,
AED.DESIGNATION
,SUPERVISOR_ID
,SUPERVISOR_NAME
--APPS.XXAKG_ORACLE_PKG.GET_CONTACT_NUMBER (AED.person_id, 'C1')OFFICE_NUMBER,
--CA.ATTRIBUTE9 "Officer Phone Number"
--CA.ACCOUNT_NAME,
--CA.STATUS ACCOUNT_STATUS,
--CSUA.STATUS CUSTOMER_SITE_STATUS,
--CA.CREATION_DATE "ACCOUNT CREATION DATE",
--CASA.CREATION_DATE "ACCOUNT SITE CREATION DATE",
--CSUA.SITE_USE_CODE,
--CSUA.LOCATION
--,RBC.*
FROM
APPS.HZ_CUST_ACCOUNTS CA,
APPS.HZ_PARTIES HP,
APPS.HZ_CUST_SITE_USES_ALL CSUA,
APPS.HZ_CUST_ACCT_SITES_ALL CASA
,APPS.XXAKG_REGION_BLOCK_CELL_V RBC
,APPS.PER_PHONES PP
,APPS.AKG_EMPLOYEE_DETAILS AED
WHERE 1=1
AND CA.CUST_ACCOUNT_ID=RBC.CUSTOMER_ID
AND CA.PARTY_ID=HP.PARTY_ID
AND CSUA.CUST_ACCT_SITE_ID=CASA.CUST_ACCT_SITE_ID
AND CA.CUST_ACCOUNT_ID=CASA.CUST_ACCOUNT_ID
AND CA.STATUS='A'
--AND CSUA.STATUS='A'
--AND PERSON_STATUS='Active Assignment'
AND PP.PHONE_NUMBER=CA.ATTRIBUTE9
AND AED.PERSON_ID=PP.PARENT_ID 
AND CA.ATTRIBUTE9 IS NOT NULL
--AND CA.ATTRIBUTE9='01713441645'
AND CSUA.SITE_USE_CODE='BILL_TO'
--AND RBC.CUSTOMER_NUMBER='34262'
AND RBC.ORG_ID=85
--AND EMPLOYEE_NUMBER--=:P_EMPLOYEE_NUMBER
--IN ('1609',
--'2115',
--'23771',
--'12726',
--'23778',
--'26893',
--'1904',
--'8245',
--'22546',
--'35437',
--'13901',
--'10842',
--'37162',
--'25016',
--'29364',
--'12725',
--'14192',
--'22548',
--'23768',
--'13718',
--'2239',
--'1906',
--'34411',
--'23769',
--'13035',
--'2014',
--'33345',
--'13730',
--'25237',
--'27124',
--'20579',
--'25321',
--'23787',
--'13993',
--'23789',
--'25328',
--'14406',
--'14405',
--'25327',
--'14322',
--'14404',
--'14408',
--'14376',
--'25749',
--'13720',
--'22547',
--'13922',
--'18330',
--'14377',
--'14367',
--'7969',
--'13729',
--'13719')